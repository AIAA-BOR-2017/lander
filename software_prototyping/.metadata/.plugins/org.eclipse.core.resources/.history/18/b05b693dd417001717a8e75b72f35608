#include <msp430.h> 
#include "hw.h"
#include "lander_os.h"

/*
 * main.c
 */

// globals
cmd queue[CMD_QUEUE_LEN];
cmd* queue_head = queue;
cmd* queue_tail = queue;
cmd queue_cnt = 0;




int main(void) {
    WDTCTL = WDTPW | WDTHOLD;	// Stop watchdog timer
	
    initial_config();

    wait_for_landing();

    landing_config();

    while (1) {
        if (!queue_cnt){ // queue not empty
            process_command(pop(queue_head));
        }
        _BIS_SR(GIE | LPM3); // go to LPM with interrupts enabled
    }

	return 0;
}
